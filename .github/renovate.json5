{
  $schema: "https://docs.renovatebot.com/renovate-schema.json",

  extends: ["config:best-practices"],

  timezone: "Etc/UTC",
  schedule: ["before 3am on saturday"],

  // What managers Renovate should run
  enabledManagers: ["nix", "regex", "github-actions"],

  // Nix flakes + *.nix
  nix: {
    enabled: false,
    fileMatch: ["flake\\.nix$", "flake\\.lock$", "\\.nix$"],
  },

  // ---- REGEX MANAGER ----
  // Extract Docker images from *.nix files
  regexManagers: [
    {
      fileMatch: ["\\.nix$"],
      matchStrings: [
        // image = "ghcr.io/sdr-enthusiasts/docker-adsb-ultrafeeder:latest-build-838"
        'image\\s*=\\s*"(?<depName>[^:"]+):(?<currentValue>[^"]+)"',
      ],
      datasourceTemplate: "docker",
    },
  ],

  // ---- PACKAGE RULES ----
  packageRules: [
    {
      // Only apply to Docker deps
      matchDatasources: ["docker"],
      // Apply docker versioning (NOT semver)
      versioning: "loose",
      commitMessageTopic: "Docker image",
    },

    {
      // SDR-Enthusiasts ecosystem
      matchDepNames: ["ghcr.io/sdr-enthusiasts/*", "ghcr.io/plane-watch/*"],
      versioning: "loose",
    },
  ],
}
