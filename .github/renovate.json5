{
  $schema: "https://docs.renovatebot.com/renovate-schema.json",

  extends: ["config:best-practices"],

  enabledManagers: ["nix", "github-actions"],

  regexManagers: [
    {
      fileMatch: ["\\.nix$"],
      matchStrings: [
        'image\\s*=\\s*"(?<depName>[^:]+):(?<currentValue>[^"]+)"',
      ],
      datasourceTemplate: "docker", // allow native behavior
      // NO custom versioning
    },
  ],

  packageRules: [
    {
      matchManagers: ["regex"],
      matchDatasources: ["docker"],
      // treat non-semver tags as immutable digests
      pinDigests: true,
    },
  ],
}
