{
  $schema: "https://docs.renovatebot.com/renovate-schema.json",

  extends: ["config:best-practices"],

  timezone: "Etc/UTC",
  schedule: ["before 3am on saturday"],

  enabledManagers: ["regex", "nix", "github-actions"],

  // --- Nix updates ---
  nix: {
    enabled: true,
    fileMatch: ["flake\\.nix$", "flake\\.lock$", "configuration\\.nix$"],
  },

  // --- Regex manager to detect Docker images in Nix files ---
  regexManagers: [
    {
      fileMatch: ["(^|/services/myapp/)image\\.nix$"],
      matchStrings: ['image = "(?<depName>.*?):(?<currentValue>.*?)";'],
      datasourceTemplate: "docker",
    },
  ],
  packageRules: [
    {
      matchDatasources: ["docker"],
      // Use "semver" if you know the image strictly uses it, otherwise use default
      versioning: "semver",
    },
  ],
}
